"use strict";(self.webpackChunkapi_based_webapp=self.webpackChunkapi_based_webapp||[]).push([[826],{421:()=>{},138:(e,t,n)=>{n.a(e,(async(e,t)=>{try{n(421);var a=n(641),s=n(259);const e="https://api.tvmaze.com/shows",i=()=>{document.getElementById("title-template").cloneNode(!0).textContent="API-based-webap"},o=async()=>{i()};window.addEventListener("load",o);const c=await a.Z.getTvShows(e);await s.Z.displayTvShows(c.list),await s.Z.addCommentEventListner(),s.Z.addModal(),t()}catch(e){t(e)}}),1)},641:(e,t,n)=>{n.d(t,{Z:()=>s});const a=class{constructor(e,t,n,a,s,i,o,c){this.id=e,this.name=t,this.type=n,this.language=a,this.genres=s,this.rating=i,this.image=o,this.summary=c}},s={getTvShows:async e=>{const t=new class{constructor(e=[]){this.list=e}push(e){this.list.push(e)}};return(await fetch(e).then((e=>e.json())).then((e=>e))).forEach((e=>{t.push(new a(e.id,e.name,e.type,e.language,e.genres[0],e.rating.average,e.image.medium,e.summary))})),t},getTvShow:async e=>{const t=await fetch(e).then((e=>e.json())).then((e=>e));return new a(t.id,t.name,t.type,t.language,t.genres[0],t.rating.average,t.image.medium,t.summary)},getlike:async e=>(await fetch(e,{method:"GET"})).json(),like:async(e,t)=>{await fetch(e,{method:"POST",body:JSON.stringify({item_id:t}),headers:{"Content-type":"application/json; charset=UTF-8"}})},getComments:async(e,t)=>{const n=new class{constructor(e=[]){this.List=e}push(e){this.List.push(e)}};try{(await fetch(`${e}?item_id=${t}`).then((e=>{if(e.ok)return e.json();throw new Error("not okay response")}))).forEach((e=>{n.push(new class{constructor(e,t,n){this.item_id=e,this.username=t,this.comment=n}}(e.item_id,e.username,e.comment))}))}catch{return n}return n},comment:async(e,t,n,a)=>(await fetch(e,{method:"POST",body:JSON.stringify({item_id:t,username:n,comment:a}),headers:{"Content-type":"application/json; charset=UTF-8"}})).status}},259:(e,t,n)=>{n.d(t,{Z:()=>d});var a=n(641);const s="https://us-central1-involvement-api.cloudfunctions.net/capstoneApi/apps/Sff4TpvfhVNiDO6YpeWb/comments",i=document.querySelector(".flex-container"),o=document.querySelector(".modal-detail-img"),c=document.querySelector(".modal-detail-text"),r=document.querySelector(".form-add-submit"),m=async e=>{const t=await a.Z.getComments(s,e),n=document.querySelector(".modal-view-comment");document.querySelector(".comment-counter").innerHTML=`(${t.List.length})`;let i="";t.List.forEach((e=>{i+=`<textarea name="" id="" cols="50" rows="1" disabled>"${e.comment}"- ${e.username}</textarea>`})),n.innerHTML=i},d={displayTvShows:async e=>{let t="";e.forEach((e=>{t+=`\n<div class="shows">\n\n   <div class="img-container">\n     <img src="${e.image}" alt="photo">\n   </div>\n   <div id="1">\n     ${e.id}  ${e.name}\n   </div>\n   <div class="reaction">\n     <button>like</button>\n     <button class="comment" data-id="${e.id}">comment</button>\n   </div>\n</div>\n`})),i.innerHTML=t},addModal:async()=>{const e=document.getElementById("myModal"),t=document.querySelectorAll(".comment");document.querySelector(".close").addEventListener("click",(()=>{e.style.display="none"})),t.forEach((t=>{t.addEventListener("click",(async()=>{const n=t.getAttribute("data-id"),s=await a.Z.getTvShow(`https://api.tvmaze.com/shows/${n}`);await m(n),r.setAttribute("data-id",n),o.innerHTML=`<img src = ${s.image}>`,c.innerHTML=`\n<p> Name:${s.name} </p>\n<p> Language:${s.language}</p>\n<p> Type:${s.type}</p>\n<p> Gener:${s.genress}</p>\n<p> Average rating:${s.rating.average}</p>\n<P>${s.summary}</p>\n      `,e.style.display="block"}))}))},addCommentEventListner:async()=>{const e=document.querySelector(".form-add-name"),t=document.querySelector(".form-add-comment");r.addEventListener("click",(async()=>{const n=r.getAttribute("data-id");await a.Z.comment(s,n,e.value,t.value),await m(n),e.value="",t.value=""}))}}}},e=>{e(e.s=138)}]);
//# sourceMappingURL=data:application/json;charset=utf-8;base64,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Q3RCZ0QsRUFBT2lCLGFBQWEsVUFBV2pFLEdBQy9COEMsRUFBWU0sVUFBWSxjQUFjN0IsRUFBVWpCLFNBQ2hEeUMsRUFBV0ssVUFBWSxjQUNsQjdCLEVBQVV0QiwyQkFDTnNCLEVBQVVwQiwwQkFDZG9CLEVBQVVyQix1QkFDVHFCLEVBQVUyQyxtQ0FDRDNDLEVBQVVsQixPQUFPZSxtQkFDakNHLEVBQVVoQixzQkFFVG9ELEVBQU1HLE1BQU1DLFFBQVUsT0FBTyxHQUM3QixHQUNGLEVBZXVDSSx1QkFaWnpFLFVBQzdCLE1BQU1PLEVBQU9aLFNBQVN3RCxjQUFjLGtCQUM5QlYsRUFBVTlDLFNBQVN3RCxjQUFjLHFCQUN2Q0csRUFBT3BELGlCQUFpQixTQUFTRixVQUMvQixNQUFNTSxFQUFLZ0QsRUFBT2dCLGFBQWEsaUJBQ3pCLFlBQW1CckIsRUFBWTNDLEVBQUlDLEVBQUttRSxNQUFPakMsRUFBUWlDLGFBQ3ZEbkIsRUFBZ0JqRCxHQUN0QkMsRUFBS21FLE1BQVEsR0FDYmpDLEVBQVFpQyxNQUFRLEVBQUUsR0FDbEIsRSIsInNvdXJjZXMiOlsid2VicGFjazovL2FwaS1iYXNlZC13ZWJhcHAvLi9zcmMvaW5kZXguanMiLCJ3ZWJwYWNrOi8vYXBpLWJhc2VkLXdlYmFwcC8uL3NyYy9tb2R1bGUvbW92aWVMaXN0LmpzIiwid2VicGFjazovL2FwaS1iYXNlZC13ZWJhcHAvLi9zcmMvbW9kdWxlL21vdmllLmpzIiwid2VicGFjazovL2FwaS1iYXNlZC13ZWJhcHAvLi9zcmMvbW9kdWxlL2FwaVNlcnZpY2UuanMiLCJ3ZWJwYWNrOi8vYXBpLWJhc2VkLXdlYmFwcC8uL3NyYy9tb2R1bGUvQ29tbWVudExpc3QuanMiLCJ3ZWJwYWNrOi8vYXBpLWJhc2VkLXdlYmFwcC8uL3NyYy9tb2R1bGUvY29tbWVudC5qcyIsIndlYnBhY2s6Ly9hcGktYmFzZWQtd2ViYXBwLy4vc3JjL21vZHVsZS9kb21TZXJ2aWNlLmpzIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCAnLi9zdHlsZS5zY3NzJztcbmltcG9ydCBhcGlTZXJ2aWNlIGZyb20gJy4vbW9kdWxlL2FwaVNlcnZpY2UuanMnO1xuaW1wb3J0IGRvbVNlcnZpY2UgZnJvbSAnLi9tb2R1bGUvZG9tU2VydmljZS5qcyc7XG5cbmNvbnN0IG1vdmllc1VybCA9ICdodHRwczovL2FwaS50dm1hemUuY29tL3Nob3dzJztcblxuY29uc3QgaW5pdFRlbXBsYXRlID0gKCkgPT4ge1xuICBjb25zdCB0aXRsZVRlbXBsYXRlRWxlbWVudCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCd0aXRsZS10ZW1wbGF0ZScpO1xuICBjb25zdCBuZXd0aXRsZUVsZW1lbnQgPSB0aXRsZVRlbXBsYXRlRWxlbWVudC5jbG9uZU5vZGUodHJ1ZSk7XG5cbiAgbmV3dGl0bGVFbGVtZW50LnRleHRDb250ZW50ID0gJ0FQSS1iYXNlZC13ZWJhcCc7XG5cbiAgLy8gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignaGVhZGVyJykuYXBwZW5kQ2hpbGQobmV3dGl0bGVFbGVtZW50KTtcbn07XG5cbmNvbnN0IGluaXQgPSBhc3luYyAoKSA9PiB7XG4gIGluaXRUZW1wbGF0ZSgpO1xufTtcbndpbmRvdy5hZGRFdmVudExpc3RlbmVyKCdsb2FkJywgaW5pdCk7XG5cbmNvbnN0IG1vdmllcyA9IGF3YWl0IGFwaVNlcnZpY2UuZ2V0VHZTaG93cyhtb3ZpZXNVcmwpO1xuYXdhaXQgZG9tU2VydmljZS5kaXNwbGF5VHZTaG93cyhtb3ZpZXMubGlzdCk7XG5hd2FpdCBkb21TZXJ2aWNlLmFkZENvbW1lbnRFdmVudExpc3RuZXIoKTtcbmRvbVNlcnZpY2UuYWRkTW9kYWwoKTtcbiIsImNsYXNzIE1vdmllTGlzdCB7XG4gIGNvbnN0cnVjdG9yKGxpc3QgPSBbXSkge1xuICAgIHRoaXMubGlzdCA9IGxpc3Q7XG4gIH1cblxuICBwdXNoKG1vdmllKSB7XG4gICAgdGhpcy5saXN0LnB1c2gobW92aWUpO1xuICB9XG59XG5cbmV4cG9ydCBkZWZhdWx0IE1vdmllTGlzdDtcbiIsImNsYXNzIE1vdmllIHtcbiAgY29uc3RydWN0b3IoaWQsIG5hbWUsIHR5cGUsIGxhbmd1YWdlLCBnZW5yZXMsIHJhdGluZywgaW1hZ2UsIHN1bW1hcnkpIHtcbiAgICB0aGlzLmlkID0gaWQ7XG4gICAgdGhpcy5uYW1lID0gbmFtZTtcbiAgICB0aGlzLnR5cGUgPSB0eXBlO1xuICAgIHRoaXMubGFuZ3VhZ2UgPSBsYW5ndWFnZTtcbiAgICB0aGlzLmdlbnJlcyA9IGdlbnJlcztcbiAgICB0aGlzLnJhdGluZyA9IHJhdGluZztcbiAgICB0aGlzLmltYWdlID0gaW1hZ2U7XG4gICAgdGhpcy5zdW1tYXJ5ID0gc3VtbWFyeTtcbiAgfVxufVxuXG5leHBvcnQgZGVmYXVsdCBNb3ZpZTtcbiIsImltcG9ydCBNb3ZpZUxpc3QgZnJvbSAnLi9tb3ZpZUxpc3QuanMnO1xuaW1wb3J0IE1vdmllIGZyb20gJy4vbW92aWUuanMnO1xuaW1wb3J0IENvbW1lbnRMaXN0IGZyb20gJy4vQ29tbWVudExpc3QuanMnO1xuaW1wb3J0IENvbW1lbnQgZnJvbSAnLi9jb21tZW50LmpzJztcblxuY29uc3QgZ2V0VHZTaG93cyA9IGFzeW5jICh1cmwpID0+IHtcbiAgY29uc3QgYWxsTW92aWVzID0gbmV3IE1vdmllTGlzdCgpO1xuICBjb25zdCBtb3ZpZXMgPSBhd2FpdCBmZXRjaCh1cmwpXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZSk7XG4gIG1vdmllcy5mb3JFYWNoKChlbGVtZW50KSA9PiB7XG4gICAgYWxsTW92aWVzLnB1c2goXG4gICAgICBuZXcgTW92aWUoXG4gICAgICAgIGVsZW1lbnQuaWQsXG4gICAgICAgIGVsZW1lbnQubmFtZSxcbiAgICAgICAgZWxlbWVudC50eXBlLFxuICAgICAgICBlbGVtZW50Lmxhbmd1YWdlLFxuICAgICAgICBlbGVtZW50LmdlbnJlc1swXSxcbiAgICAgICAgZWxlbWVudC5yYXRpbmcuYXZlcmFnZSxcbiAgICAgICAgZWxlbWVudC5pbWFnZS5tZWRpdW0sXG4gICAgICAgIGVsZW1lbnQuc3VtbWFyeSxcbiAgICAgICksXG4gICAgKTtcbiAgfSk7XG4gIHJldHVybiBhbGxNb3ZpZXM7XG59O1xuY29uc3QgZ2V0VHZTaG93ID0gYXN5bmMgKHVybCkgPT4ge1xuICBjb25zdCBtb3ZpZURhdGEgPSBhd2FpdCBmZXRjaCh1cmwpXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZS5qc29uKCkpXG4gICAgLnRoZW4oKHJlc3BvbnNlKSA9PiByZXNwb25zZSk7XG4gIGNvbnN0IHJlc3VsdCA9IG5ldyBNb3ZpZShcbiAgICBtb3ZpZURhdGEuaWQsXG4gICAgbW92aWVEYXRhLm5hbWUsXG4gICAgbW92aWVEYXRhLnR5cGUsXG4gICAgbW92aWVEYXRhLmxhbmd1YWdlLFxuICAgIG1vdmllRGF0YS5nZW5yZXNbMF0sXG4gICAgbW92aWVEYXRhLnJhdGluZy5hdmVyYWdlLFxuICAgIG1vdmllRGF0YS5pbWFnZS5tZWRpdW0sXG4gICAgbW92aWVEYXRhLnN1bW1hcnksXG4gICk7XG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCBnZXRsaWtlID0gYXN5bmMgKHVybCkgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwgeyBtZXRob2Q6ICdHRVQnIH0pO1xuICByZXR1cm4gcmVzcG9uc2UuanNvbigpO1xufTtcbmNvbnN0IGxpa2UgPSBhc3luYyAodXJsLCBpZCkgPT4ge1xuICBhd2FpdCBmZXRjaCh1cmwsIHtcbiAgICBtZXRob2Q6ICdQT1NUJyxcbiAgICBib2R5OiBKU09OLnN0cmluZ2lmeSh7XG4gICAgICBpdGVtX2lkOiBpZCxcbiAgICB9KSxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnLFxuICAgIH0sXG4gIH0pO1xufTtcbmNvbnN0IGdldENvbW1lbnRzID0gYXN5bmMgKHVybCwgaWQpID0+IHtcbiAgY29uc3QgcmVzdWx0ID0gbmV3IENvbW1lbnRMaXN0KCk7XG4gIHRyeSB7XG4gICAgY29uc3QgY29tbWVudHMgPSBhd2FpdCBmZXRjaChgJHt1cmx9P2l0ZW1faWQ9JHtpZH1gKS50aGVuKChyZXNwb25zZSkgPT4ge1xuICAgICAgaWYgKHJlc3BvbnNlLm9rKSB7XG4gICAgICAgIHJldHVybiByZXNwb25zZS5qc29uKCk7XG4gICAgICB9XG4gICAgICB0aHJvdyBuZXcgRXJyb3IoJ25vdCBva2F5IHJlc3BvbnNlJyk7XG4gICAgfSk7XG4gICAgY29tbWVudHMuZm9yRWFjaCgoYykgPT4ge1xuICAgICAgcmVzdWx0LnB1c2gobmV3IENvbW1lbnQoYy5pdGVtX2lkLCBjLnVzZXJuYW1lLCBjLmNvbW1lbnQpKTtcbiAgICB9KTtcbiAgfSBjYXRjaCB7XG4gICAgcmV0dXJuIHJlc3VsdDtcbiAgfVxuXG4gIHJldHVybiByZXN1bHQ7XG59O1xuXG5jb25zdCBjb21tZW50ID0gYXN5bmMgKHVybCwgaXRlbUlkLCB1c2VybmFtZSwgY29tbWVudCkgPT4ge1xuICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKHVybCwge1xuICAgIG1ldGhvZDogJ1BPU1QnLFxuICAgIGJvZHk6IEpTT04uc3RyaW5naWZ5KHtcbiAgICAgIGl0ZW1faWQ6IGl0ZW1JZCxcbiAgICAgIHVzZXJuYW1lLFxuICAgICAgY29tbWVudCxcbiAgICB9KSxcbiAgICBoZWFkZXJzOiB7XG4gICAgICAnQ29udGVudC10eXBlJzogJ2FwcGxpY2F0aW9uL2pzb247IGNoYXJzZXQ9VVRGLTgnLFxuICAgIH0sXG4gIH0pO1xuICByZXR1cm4gcmVzcG9uc2Uuc3RhdHVzO1xufTtcblxuZXhwb3J0IGRlZmF1bHQge1xuICBnZXRUdlNob3dzLFxuICBnZXRUdlNob3csXG4gIGdldGxpa2UsXG4gIGxpa2UsXG4gIGdldENvbW1lbnRzLFxuICBjb21tZW50LFxufTtcbiIsImNsYXNzIENvbW1lbnRMaXN0IHtcbiAgY29uc3RydWN0b3IobGlzdCA9IFtdKSB7XG4gICAgdGhpcy5MaXN0ID0gbGlzdDtcbiAgfVxuXG4gIHB1c2goY29tbWVudCkge1xuICAgIHRoaXMuTGlzdC5wdXNoKGNvbW1lbnQpO1xuICB9XG59XG5leHBvcnQgZGVmYXVsdCBDb21tZW50TGlzdDsiLCJjbGFzcyBDb21tZW50IHtcbiAgY29uc3RydWN0b3IoaXRlbWlkLCB1c2VybmFtZSwgY29tbWVudCkge1xuICAgIHRoaXMuaXRlbV9pZCA9IGl0ZW1pZDtcbiAgICB0aGlzLnVzZXJuYW1lID0gdXNlcm5hbWU7XG4gICAgdGhpcy5jb21tZW50ID0gY29tbWVudDtcbiAgfVxufVxuZXhwb3J0IGRlZmF1bHQgQ29tbWVudDsiLCJpbXBvcnQgYXBpU2VydmljZSBmcm9tICcuL2FwaVNlcnZpY2UuanMnO1xuXG5jb25zdCBtb3ZpZXNVcmwgPSAnaHR0cHM6Ly9hcGkudHZtYXplLmNvbS9zaG93cyc7XG5jb25zdCBjb21tZW50VXJsID0gJ2h0dHBzOi8vdXMtY2VudHJhbDEtaW52b2x2ZW1lbnQtYXBpLmNsb3VkZnVuY3Rpb25zLm5ldC9jYXBzdG9uZUFwaS9hcHBzL1NmZjRUcHZmaFZOaURPNllwZVdiL2NvbW1lbnRzJztcbmNvbnN0IGNvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mbGV4LWNvbnRhaW5lcicpO1xuY29uc3QgZGV0YWlsSW1hZ2UgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcubW9kYWwtZGV0YWlsLWltZycpO1xuY29uc3QgZGV0YWlsVGV4dCA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC1kZXRhaWwtdGV4dCcpO1xuY29uc3Qgc3VibWl0ID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvcignLmZvcm0tYWRkLXN1Ym1pdCcpO1xuXG5jb25zdCBkaXNwbGF5Q29tbWVudHMgPSBhc3luYyAoaWQpID0+IHtcbiAgY29uc3QgY29tbWVudHMgPSBhd2FpdCBhcGlTZXJ2aWNlLmdldENvbW1lbnRzKGNvbW1lbnRVcmwsIGlkKTtcbiAgY29uc3QgY29tbWVudENvbnRhaW5lciA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5tb2RhbC12aWV3LWNvbW1lbnQnKTtcbiAgY29uc3QgY29tbWVudENvdW50ZXIgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY29tbWVudC1jb3VudGVyJyk7XG4gIGNvbW1lbnRDb3VudGVyLmlubmVySFRNTCA9IGAoJHtjb21tZW50cy5MaXN0Lmxlbmd0aH0pYDtcbiAgbGV0IGh0bWxWYWx1ZSA9ICcnO1xuICBjb21tZW50cy5MaXN0LmZvckVhY2goKGVsZW1lbnQpID0+IHtcbiAgICBodG1sVmFsdWUgKz0gYDx0ZXh0YXJlYSBuYW1lPVwiXCIgaWQ9XCJcIiBjb2xzPVwiNTBcIiByb3dzPVwiMVwiIGRpc2FibGVkPlwiJHtlbGVtZW50LmNvbW1lbnR9XCItICR7ZWxlbWVudC51c2VybmFtZX08L3RleHRhcmVhPmA7XG4gIH0pO1xuICBjb21tZW50Q29udGFpbmVyLmlubmVySFRNTCA9IGh0bWxWYWx1ZTtcbn07XG5jb25zdCBkaXNwbGF5VHZTaG93cyA9IGFzeW5jIChtb3ZpZXMpID0+IHtcbiAgbGV0IGZpbG1EYXRhID0gJyc7XG4gIG1vdmllcy5mb3JFYWNoKChlKSA9PiB7XG4gICAgZmlsbURhdGEgKz0gYFxuPGRpdiBjbGFzcz1cInNob3dzXCI+XG5cbiAgIDxkaXYgY2xhc3M9XCJpbWctY29udGFpbmVyXCI+XG4gICAgIDxpbWcgc3JjPVwiJHtlLmltYWdlfVwiIGFsdD1cInBob3RvXCI+XG4gICA8L2Rpdj5cbiAgIDxkaXYgaWQ9XCIxXCI+XG4gICAgICR7ZS5pZH0gICR7ZS5uYW1lfVxuICAgPC9kaXY+XG4gICA8ZGl2IGNsYXNzPVwicmVhY3Rpb25cIj5cbiAgICAgPGJ1dHRvbj5saWtlPC9idXR0b24+XG4gICAgIDxidXR0b24gY2xhc3M9XCJjb21tZW50XCIgZGF0YS1pZD1cIiR7ZS5pZH1cIj5jb21tZW50PC9idXR0b24+XG4gICA8L2Rpdj5cbjwvZGl2PlxuYDtcbiAgfSk7XG4gIGNvbnRhaW5lci5pbm5lckhUTUwgPSBmaWxtRGF0YTtcbn07XG5cbmNvbnN0IGFkZE1vZGFsID0gYXN5bmMgKCkgPT4ge1xuICBjb25zdCBtb2RhbCA9IGRvY3VtZW50LmdldEVsZW1lbnRCeUlkKCdteU1vZGFsJyk7XG4gIGNvbnN0IGNvbW1lbnRCdXR0b25zID0gZG9jdW1lbnQucXVlcnlTZWxlY3RvckFsbCgnLmNvbW1lbnQnKTtcbiAgY29uc3QgY2xvc2VidXR0b24gPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuY2xvc2UnKTtcblxuICBjbG9zZWJ1dHRvbi5hZGRFdmVudExpc3RlbmVyKCdjbGljaycsICgpID0+IHtcbiAgICBtb2RhbC5zdHlsZS5kaXNwbGF5ID0gJ25vbmUnO1xuICB9KTtcbiAgY29tbWVudEJ1dHRvbnMuZm9yRWFjaCgoZWxlbWVudCkgPT4ge1xuICAgIGVsZW1lbnQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgICBjb25zdCBpZCA9IGVsZW1lbnQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG4gICAgICBjb25zdCBtb3ZpZURhdGEgPSBhd2FpdCBhcGlTZXJ2aWNlLmdldFR2U2hvdyhgJHttb3ZpZXNVcmx9LyR7aWR9YCk7XG4gICAgICBhd2FpdCBkaXNwbGF5Q29tbWVudHMoaWQpO1xuICAgICAgc3VibWl0LnNldEF0dHJpYnV0ZSgnZGF0YS1pZCcsIGlkKTtcbiAgICAgIGRldGFpbEltYWdlLmlubmVySFRNTCA9IGA8aW1nIHNyYyA9ICR7bW92aWVEYXRhLmltYWdlfT5gO1xuICAgICAgZGV0YWlsVGV4dC5pbm5lckhUTUwgPSBgXG48cD4gTmFtZToke21vdmllRGF0YS5uYW1lfSA8L3A+XG48cD4gTGFuZ3VhZ2U6JHttb3ZpZURhdGEubGFuZ3VhZ2V9PC9wPlxuPHA+IFR5cGU6JHttb3ZpZURhdGEudHlwZX08L3A+XG48cD4gR2VuZXI6JHttb3ZpZURhdGEuZ2VucmVzc308L3A+XG48cD4gQXZlcmFnZSByYXRpbmc6JHttb3ZpZURhdGEucmF0aW5nLmF2ZXJhZ2V9PC9wPlxuPFA+JHttb3ZpZURhdGEuc3VtbWFyeX08L3A+XG4gICAgICBgO1xuICAgICAgbW9kYWwuc3R5bGUuZGlzcGxheSA9ICdibG9jayc7XG4gICAgfSk7XG4gIH0pO1xufTtcblxuY29uc3QgYWRkQ29tbWVudEV2ZW50TGlzdG5lciA9IGFzeW5jICgpID0+IHtcbiAgY29uc3QgbmFtZSA9IGRvY3VtZW50LnF1ZXJ5U2VsZWN0b3IoJy5mb3JtLWFkZC1uYW1lJyk7XG4gIGNvbnN0IGNvbW1lbnQgPSBkb2N1bWVudC5xdWVyeVNlbGVjdG9yKCcuZm9ybS1hZGQtY29tbWVudCcpO1xuICBzdWJtaXQuYWRkRXZlbnRMaXN0ZW5lcignY2xpY2snLCBhc3luYyAoKSA9PiB7XG4gICAgY29uc3QgaWQgPSBzdWJtaXQuZ2V0QXR0cmlidXRlKCdkYXRhLWlkJyk7XG4gICAgYXdhaXQgYXBpU2VydmljZS5jb21tZW50KGNvbW1lbnRVcmwsIGlkLCBuYW1lLnZhbHVlLCBjb21tZW50LnZhbHVlKTtcbiAgICBhd2FpdCBkaXNwbGF5Q29tbWVudHMoaWQpO1xuICAgIG5hbWUudmFsdWUgPSAnJztcbiAgICBjb21tZW50LnZhbHVlID0gJyc7XG4gIH0pO1xufTtcblxuZXhwb3J0IGRlZmF1bHQgeyBkaXNwbGF5VHZTaG93cywgYWRkTW9kYWwsIGFkZENvbW1lbnRFdmVudExpc3RuZXIgfTtcbiJdLCJuYW1lcyI6WyJtb3ZpZXNVcmwiLCJpbml0VGVtcGxhdGUiLCJkb2N1bWVudCIsImdldEVsZW1lbnRCeUlkIiwiY2xvbmVOb2RlIiwidGV4dENvbnRlbnQiLCJpbml0IiwiYXN5bmMiLCJ3aW5kb3ciLCJhZGRFdmVudExpc3RlbmVyIiwibW92aWVzIiwibGlzdCIsImNvbnN0cnVjdG9yIiwiaWQiLCJuYW1lIiwidHlwZSIsImxhbmd1YWdlIiwiZ2VucmVzIiwicmF0aW5nIiwiaW1hZ2UiLCJzdW1tYXJ5IiwidGhpcyIsImdldFR2U2hvd3MiLCJ1cmwiLCJhbGxNb3ZpZXMiLCJwdXNoIiwibW92aWUiLCJmZXRjaCIsInRoZW4iLCJyZXNwb25zZSIsImpzb24iLCJmb3JFYWNoIiwiZWxlbWVudCIsImF2ZXJhZ2UiLCJtZWRpdW0iLCJnZXRUdlNob3ciLCJtb3ZpZURhdGEiLCJnZXRsaWtlIiwibWV0aG9kIiwibGlrZSIsImJvZHkiLCJKU09OIiwic3RyaW5naWZ5IiwiaXRlbV9pZCIsImhlYWRlcnMiLCJnZXRDb21tZW50cyIsInJlc3VsdCIsIkxpc3QiLCJjb21tZW50Iiwib2siLCJFcnJvciIsImMiLCJpdGVtaWQiLCJ1c2VybmFtZSIsIml0ZW1JZCIsInN0YXR1cyIsImNvbW1lbnRVcmwiLCJjb250YWluZXIiLCJxdWVyeVNlbGVjdG9yIiwiZGV0YWlsSW1hZ2UiLCJkZXRhaWxUZXh0Iiwic3VibWl0IiwiZGlzcGxheUNvbW1lbnRzIiwiY29tbWVudHMiLCJjb21tZW50Q29udGFpbmVyIiwiaW5uZXJIVE1MIiwibGVuZ3RoIiwiaHRtbFZhbHVlIiwiZGlzcGxheVR2U2hvd3MiLCJmaWxtRGF0YSIsImUiLCJhZGRNb2RhbCIsIm1vZGFsIiwiY29tbWVudEJ1dHRvbnMiLCJxdWVyeVNlbGVjdG9yQWxsIiwic3R5bGUiLCJkaXNwbGF5IiwiZ2V0QXR0cmlidXRlIiwic2V0QXR0cmlidXRlIiwiZ2VucmVzcyIsImFkZENvbW1lbnRFdmVudExpc3RuZXIiLCJ2YWx1ZSJdLCJzb3VyY2VSb290IjoiIn0=